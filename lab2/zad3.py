# Zaimplementuj algorytm (funkcję), który sprawdza czy punkt należy do krzywej.
# Dane:P= (x, y) oraz A, B, p= 3 (mod 4) takie, że E:Y2=X3+AX+B jest krzywą nad Fp
# Wynik: True jeśli P= (x, y) ∈ E(Fp) w przeciwnym przypadku False


def effective_power(b, k, n):
    y = 1
    binary = list(reversed(bin(k)[2:]))
    i = len(binary) - 1
    while i >= 0:
        y = (y ** 2) % n
        if binary[i] == "1":
            y = (y * b) % n
        i = i - 1
    return y


def check_if_point_belongs_to_curve(x, y, A, B, p):
    if effective_power(y, 2, p) == (effective_power(x, 3, p) + A * x + B) % p:
        return True
    else:
        return False


print(check_if_point_belongs_to_curve(5, 1, 6, 0, 11))
print(check_if_point_belongs_to_curve(10, 9, 6, 0, 11))

print(check_if_point_belongs_to_curve(285113634279465403319996581740169338329454608669814309137990174814243655992779447106132850,
                                      598700530906084162596261101440667782569915319623798143751082061599951188013331503150304328,
                                      239614427021073265587611886177902927263167863041565491257781227550405368115731464059190159,
                                      447169285435982716467332439542997876345372330045685811964291613238129105735899852114277221,
                                      1183779584357076950937981497685946292711107412152534481102525547387604378262522402526266939))

print(check_if_point_belongs_to_curve(3224560530800846681010680122085616342105068103976973437923049252616388441908964303205172986,
                                      3868781278576523491772112942080376762195328540424175402448760021674499319725602158729657976,
                                      3951502613668786427508319038807867040712174447869623952933414625226341100441832932481097361,
                                      3224696620918517361434419666603980511362432444220251166308109762688821389727537860336481646,
                                      4780750005034460926387212098221027725656916132929395258166013370241258731572975472324340707))